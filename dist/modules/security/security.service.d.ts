import { ConfigService } from '@nestjs/config';
import { JwtService } from '@nestjs/jwt';
import { NotificationService } from './../notification/notification.service';
import { Model } from 'mongoose';
import { Token } from './schema/tokens.schema';
import { UserService } from './../user/user.service';
import { IAuthUser } from './../../types/user.types';
import { EmailPurpose } from './../../utils/constant';
import Result from 'src/wrapper/result';
import { UserDocument } from '../user/schema/user.schema';
export declare class SecurityService {
    private readonly jwtService;
    private readonly configService;
    private readonly notificationService;
    private readonly tokenModel;
    private readonly userService;
    constructor(jwtService: JwtService, configService: ConfigService, userService: UserService, notificationService: NotificationService, tokenModel: Model<Token>);
    signToken(user: IAuthUser, ttl: number): Promise<Result<string | null>>;
    validateToken(token: string): Promise<Result<IAuthUser | null>>;
    hash(data: string): Promise<Result<string | null>>;
    compare(incomingData: string, hashedData: string): Promise<Result<boolean | null>>;
    generateTokens(user: IAuthUser, tokenTTL: number): Promise<Result<string | null>>;
    queueVerificationEmail(emailAddress: string, subject: string, emailPurpose: EmailPurpose): Promise<Result<boolean | null>>;
    private verifyToken;
    verifyEmail(token: string): Promise<Result<UserDocument | null>>;
    updatePassword(oldPassword: string, newPassword: string, userId: string): Promise<Result<UserDocument | null>>;
    updateEmail(newEmailAddress: string, userId: string): Promise<Result<UserDocument | null>>;
    passwordResetRequest(emailAddress: string): Promise<Result<boolean | null>>;
    passwordReset(token: string, password: string): Promise<Result<boolean | null>>;
}
